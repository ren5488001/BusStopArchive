# 项目管理页面菜单配置说明

## 一、路由配置（已完成）

### 1. 静态路由配置

已添加到 `react-ui/config/routes.ts`：

```typescript
{
  name: 'project',
  path: '/project',
  component: './Project',
  icon: 'build',
}
```

### 2. 国际化配置

已添加到 `react-ui/src/locales/zh-CN/menu.ts`：

```typescript
'menu.project': '项目管理',
```

## 二、数据库菜单配置步骤

### 方式一：直接在数据库中执行 SQL（推荐）

#### 步骤 1：插入项目管理菜单

在数据库中执行以下 SQL：

```sql
-- 插入项目管理菜单（作为顶级菜单）
INSERT INTO sys_menu VALUES(
  '2001',                              -- menu_id: 菜单ID（唯一，建议使用2001）
  '项目管理',                            -- menu_name: 菜单名称
  '0',                                 -- parent_id: 父菜单ID（0表示顶级菜单）
  '10',                                -- order_num: 显示顺序（数字越小越靠前，建议放在系统管理后面）
  'project',                           -- path: 路由地址（访问路径，对应 /project）
  'Project/index',                     -- component: 组件路径（对应 src/pages/Project/index.tsx）
  '',                                  -- query: 路由参数（一般为空）
  'project',                           -- route_name: 路由名称（可选，用于国际化）
  '1',                                 -- is_frame: 是否为外链（1否 0是）
  '0',                                 -- is_cache: 是否缓存（0缓存 1不缓存）
  'C',                                 -- menu_type: 菜单类型（M目录 C菜单 F按钮）
  '0',                                 -- visible: 显示状态（0显示 1隐藏）
  '0',                                 -- status: 菜单状态（0正常 1停用）
  'project:view',                      -- perms: 权限标识（可设置如 project:view）
  'BuildOutlined',                     -- icon: 菜单图标（Ant Design图标名）
  'admin',                             -- create_by: 创建者
  sysdate(),                           -- create_time: 创建时间
  '',                                  -- update_by: 更新者
  null,                                -- update_time: 更新时间
  '项目管理菜单'                         -- remark: 备注
);
```

**重要说明**：
- `component` 字段的值是 `Project/index`，前端会自动转换为 `src/pages/Project/index.tsx`
- `path` 字段的值是 `project`，对应路由路径 `/project`
- `menu_type` 设置为 `C`（菜单），因为这是直接跳转的页面，没有子菜单

### 方式二：通过系统菜单管理界面添加

1. 登录系统
2. 进入“系统管理” → “菜单管理”
3. 点击“新增”按钮
4. 填写以下信息：

#### 菜单信息
- **菜单名称**: `项目管理`
- **父菜单**: `主类目`（顶级菜单）
- **显示顺序**: `10`（可根据需要调整）
- **路由地址**: `project`
- **组件路径**: `Project/index`
- **菜单类型**: `菜单`（C）
- **菜单图标**: `BuildOutlined` 或 `build`
- **显示状态**: `显示`
- **菜单状态**: `正常`
- **权限标识**: `project:view`（可选，用于权限控制）

#### 组件路径说明

根据前端代码逻辑（`react-ui/src/services/session.ts`），组件路径转换规则：

- 数据库中的 `component` 字段：`Project/index`
- 系统会自动转换为：`src/pages/Project/index.tsx`
- 转换规则：
  1. 将路径按 `/` 分割
  2. 每个部分首字母大写（除 index 外）
  3. 添加 `.tsx` 后缀
  4. 前缀 `@/pages/`

### 步骤 2：分配菜单权限（可选）

如果需要权限控制，需要将菜单权限分配给相应角色：

1. 进入“系统管理” → “角色管理”
2. 选择需要分配权限的角色（如“管理员”）
3. 点击“修改”按钮
4. 在“菜单权限”区域中勾选“项目管理”
5. 点击“确定”保存

## 三、验证步骤

### 1. 刷新页面

添加菜单后，需要刷新浏览器页面或重新登录，菜单才会显示。

### 2. 访问页面

可以通过以下方式访问：
- 点击侧边栏菜单中的“项目管理”
- 直接访问 URL：`http://localhost:8000/#/project`

### 3. 检查菜单显示

菜单应该显示在侧边栏，包含：
- 菜单图标：`BuildOutlined` 图标
- 菜单名称：项目管理
- 点击后跳转到项目管理页面

## 四、菜单配置参数说明

| 字段 | 说明 | 示例值 |
|------|------|--------|
| `menu_id` | 菜单ID，唯一标识 | `2001` |
| `menu_name` | 菜单显示名称 | `项目管理` |
| `parent_id` | 父菜单ID，0表示顶级菜单 | `0` |
| `order_num` | 显示顺序，数字越小越靠前 | `10` |
| `path` | 路由地址，对应前端路由 | `project` |
| `component` | 组件路径，对应前端文件 | `Project/index` |
| `menu_type` | 菜单类型：M目录 C菜单 F按钮 | `C` |
| `icon` | 菜单图标，Ant Design图标名 | `BuildOutlined` |
| `visible` | 显示状态：0显示 1隐藏 | `0` |
| `status` | 菜单状态：0正常 1停用 | `0` |
| `perms` | 权限标识，用于权限控制 | `project:view` |

## 五、注意事项

1. **组件路径规则**：
   - 数据库中写：`Project/index`
   - 实际文件路径：`src/pages/Project/index.tsx`
   - 系统会自动转换大小写和添加后缀

2. **菜单类型选择**：
   - 如果页面没有子菜单，使用 `C`（菜单）
   - 如果将来可能有子菜单，使用 `M`（目录）

3. **权限控制**：
   - 如果不设置 `perms`，所有登录用户都能访问
   - 如果设置了 `perms`，需要给角色分配相应权限

4. **菜单ID唯一性**：
   - 确保 `menu_id` 不与现有菜单冲突
   - 建议使用 2000 以上的 ID

## 六、常见问题

### Q1: 菜单添加后不显示？
- 检查 `visible` 字段是否为 `0`（显示）
- 检查 `status` 字段是否为 `0`（正常）
- 检查角色是否分配了菜单权限
- 刷新浏览器页面或重新登录

### Q2: 点击菜单报错？
- 检查 `component` 路径是否正确（应该是 `Project/index`）
- 检查前端文件是否存在（`src/pages/Project/index.tsx`）
- 检查浏览器控制台错误信息

### Q3: 菜单图标不显示？
- 检查 `icon` 字段是否正确（应该是 `BuildOutlined`，不是 `BuildOutlinedOutlined`）
- 确保图标名称与 Ant Design 图标库一致

## 七、完整SQL示例

```sql
-- 插入项目管理菜单
INSERT INTO sys_menu VALUES(
  '2001', '项目管理', '0', '10', 'project', 'Project/index', '', 'project',
  '1', '0', 'C', '0', '0', 'project:view', 'BuildOutlined',
  'admin', sysdate(), '', null, '项目管理菜单'
);

-- 如果使用MySQL，日期函数为 NOW() 而不是 sysdate()
-- INSERT INTO sys_menu VALUES(
--   '2001', '项目管理', '0', '10', 'project', 'Project/index', '', 'project',
--   '1', '0', 'C', '0', '0', 'project:view', 'BuildOutlined',
--   'admin', NOW(), '', null, '项目管理菜单'
-- );
```

